!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=331)}({107:function(e,t,n){var r=n(62);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.default=e.exports,e.exports.__esModule=!0},108:function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.default=e.exports,e.exports.__esModule=!0},109:function(e,t,n){var r=n(62);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.default=e.exports,e.exports.__esModule=!0},110:function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0},12:function(e,t,n){"use strict";function r(e){"complete"!==document.readyState&&"interactive"!==document.readyState?document.addEventListener("DOMContentLoaded",e):e()}n.d(t,"a",(function(){return r}))},144:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(12);function i(e,t){if(e!==t){var n=document.getElementById("simpay-test-mode-toggle-notice"),r=document.getElementById("simpay-toggle-notice-status"),i=document.getElementById("simpay-toggle-notice-status-link");n.classList.add("notice"),n.classList.add("notice-warning"),n.style.display="block",r&&i&&(r.innerHTML="<strong>"+r.dataset[e]+"</strong>",i.href=i.dataset[e])}}Object(r.a)((function(){var e=document.getElementById("simpay-stripe-account-info");e&&wp.ajax.send("simpay_stripe_connect_account_information",{data:{nonce:e.dataset.nonce,account_id:e.dataset.accountId},success:function(t){e.querySelector("p").innerHTML=t.message,e.style.display="block",e.classList.add("notice"),"simpay-stripe-activated-account-actions"===t.actions?e.classList.add("notice-info"):e.classList.add("notice-warning");var n=document.getElementById(t.actions);n&&(n.style.display="block")},error:function(t){e.querySelector("p").innerHTML=t.message,e.style.display="block",e.classList.add("notice"),e.classList.add("notice-error");var n=document.getElementById(t.actions);n&&(n.style.display="block")}})}))},20:function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return h}));var r=function(e){return"string"!=typeof e||""===e?(console.error("The namespace must be a non-empty string."),!1):!!/^[a-zA-Z][a-zA-Z0-9_.\-\/]*$/.test(e)||(console.error("The namespace can only contain numbers, letters, dashes, periods, underscores and slashes."),!1)},i=function(e){return"string"!=typeof e||""===e?(console.error("The hook name must be a non-empty string."),!1):/^__/.test(e)?(console.error("The hook name cannot begin with `__`."),!1):!!/^[a-zA-Z][a-zA-Z0-9_.-]*$/.test(e)||(console.error("The hook name can only contain numbers, letters, dashes, periods and underscores."),!1)},a=function(e){return function(t,n,a){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;if(i(t)&&r(n))if("function"==typeof a)if("number"==typeof o){var c={callback:a,priority:o,namespace:n};if(e[t]){var s,l=e[t].handlers;for(s=l.length;s>0&&!(o>=l[s-1].priority);s--);s===l.length?l[s]=c:l.splice(s,0,c),(e.__current||[]).forEach((function(e){e.name===t&&e.currentIndex>=s&&e.currentIndex++}))}else e[t]={handlers:[c],runs:0};"hookAdded"!==t&&y("hookAdded",t,n,a,o)}else console.error("If specified, the hook priority must be a number.");else console.error("The hook callback must be a function.")}},o=function(e,t){return function(n,a){if(i(n)&&(t||r(a))){if(!e[n])return 0;var o=0;if(t)o=e[n].handlers.length,e[n]={runs:e[n].runs,handlers:[]};else for(var c=e[n].handlers,s=function(t){c[t].namespace===a&&(c.splice(t,1),o++,(e.__current||[]).forEach((function(e){e.name===n&&e.currentIndex>=t&&e.currentIndex--})))},l=c.length-1;l>=0;l--)s(l);return"hookRemoved"!==n&&y("hookRemoved",n,a),o}}},c=function(e){return function(t,n){return void 0!==n?t in e&&e[t].handlers.some((function(e){return e.namespace===n})):t in e}},s=function(e,t){return function(n){e[n]||(e[n]={handlers:[],runs:0}),e[n].runs++;for(var r=e[n].handlers,i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];if(!r||!r.length)return t?a[0]:void 0;var c={name:n,currentIndex:0};for(e.__current.push(c);c.currentIndex<r.length;){var s=r[c.currentIndex],l=s.callback.apply(null,a);t&&(a[0]=l),c.currentIndex++}return e.__current.pop(),t?a[0]:void 0}},l=function(e){return function(){return e.__current&&e.__current.length?e.__current[e.__current.length-1].name:null}},u=function(e){return function(t){return void 0===t?void 0!==e.__current[0]:!!e.__current[0]&&t===e.__current[0].name}},d=function(e){return function(t){if(i(t))return e[t]&&e[t].runs?e[t].runs:0}},p=function(){var e=Object.create(null),t=Object.create(null);return e.__current=[],t.__current=[],{addAction:a(e),addFilter:a(t),removeAction:o(e),removeFilter:o(t),hasAction:c(e),hasFilter:c(t),removeAllActions:o(e,!0),removeAllFilters:o(t,!0),doAction:s(e),applyFilters:s(t,!0),currentAction:l(e),currentFilter:l(t),doingAction:u(e),doingFilter:u(t),didAction:d(e),didFilter:d(t),actions:e,filters:t}},m=p(),y=(m.addAction,m.addFilter,m.removeAction,m.removeFilter,m.hasAction,m.hasFilter,m.removeAllActions,m.removeAllFilters,m.doAction),f=(m.applyFilters,m.currentAction,m.currentFilter,m.doingAction,m.doingFilter,m.didAction,m.didFilter,m.actions,m.filters,p()),v=f.addAction,h=(f.addFilter,f.doAction);f.applyFilters,t.b=f},22:function(e,t){e.exports=jQuery},331:function(e,t,n){"use strict";n.r(t),function(e){var t=n(20),r=(n(332),n(333),n(144));n(334),n(335),window.wpsp=window.wpsp||{hooks:t.b};var i,a,o,c={};c={init:function(){a=i(document.body),o=a.find("#simpay-form-settings"),this.handleMetaboxTabClick(),window.postboxes&&window.postboxes.handle_click&&o.on("click",".postbox .simpay-hndle, .postbox .simpay-handlediv",window.postboxes.handle_click),["_amount_type","_success_redirect_type","_subscription_type","_subscription_custom_amount","_form_display_type",".simpay-total-amount-label-recurring",".simpay-total-amount-label-tax",".simpay-shipping-address",".simpay-text-multiline",".simpay-dropdown-type",".simpay-radio-type",".simpay-price-enable-custom",".simpay-price-type input"].forEach((function(e){var t=i(e),n=!1;"."!==e.substring(0,1)?t='input[name="'.concat(e,'"]'):(t=e,n=!0),i("#simpay-form-settings").on("change",t,(function(){var t=i("#simpay-form-settings");!0===n&&(t=i(this).closest(".simpay-field-data"));var r=i(this).val();i(this).is(":checkbox")&&(r=i(this).is(":checked")?"yes":"no"),t.find(i('.simpay-show-if[data-if="'.concat(e,'"]'))).each((function(){var e=i(this),t=e.data("is");e.hide(),t.includes(r)&&e.show().css("display","block")}))})),i(t).filter(":checked").trigger("change")})),t.b.addAction("settings.toggleTestMode","wpsp/settings/stripe-connect",r.a),o.on("click.simpayTabLink",".simpay-tab-link",(function(e){e.preventDefault(),c.handleInternalLinkToTabClicks(i(this))})),o.on("click.simpayImagePreview",".simpay-remove-image-preview",(function(e){c.handleRemoveImagePreviewClick(e)})),this.setupChosen(),this.addMediaFields(),this.stripeConnect();var e=i(".simpay-payment-modes");e.length&&e.find("input").each((function(){var t=i(this);e.hasClass("simpay-payment-mode--"+t.val())||t.attr("disabled",!0)})),a.trigger("simpayAdminInit")},handleRemoveImagePreviewClick:function(e){e.preventDefault(),o.find(".simpay-image-preview-wrap").hide(),o.find("#_image_url").val("")},addMediaFields:function(){var e;i(".simpay-media-uploader").on("click",(function(t){t.preventDefault(),window.simpayMediaUploaderInputField=i(this),e||(e=wp.media.frames.file_frame=wp.media({title:spGeneral.i18n.mediaTitle,button:{text:spGeneral.i18n.mediaButtonText},multiple:!1})).on("select",(function(){var t=e.state().get("selection").first().toJSON(),n=i("#_image_url"),r="id"===n.data("fvalue")?t.id:t.url;i(".simpay-image-preview-wrap").show(),i(".simpay-image-preview").prop("src",r),n.val(r)})),e.open()}))},setupChosen:function(){var e=i(".simpay-chosen-select, .simpay-chosen-search");e.chosen({disable_search_threshold:20}),e.chosen()},handleMetaboxTabClick:function(){var e=i("ul.simpay-tabs a"),t=i("div.simpay-panel"),n=e.parents("li");e.on("click",(function(e){e.preventDefault();var r=i(this).parent(),a=i(i(this).attr("href")),o=i(this).attr("href");history.pushState(null,null,o),setTimeout((function(){window.scrollTo(0,0)}),1),i('[name="simpay_form_settings_tab"]').val(o),i(".simpay-panels > .spinner").hide(),n.removeClass("active"),r.addClass("active"),t.addClass("simpay-panel-hidden"),a.removeClass("simpay-panel-hidden")}));var r="#form-display-options-settings-panel";location.hash.length&&(r=location.hash);var a=i('ul.simpay-tabs a[href="'+r+'"]');i('[name="simpay_form_settings_tab"]').val(r),a.length&&a.click()},stripeConnect:function(){var e="tr:nth-child(2), tr:nth-child(3), tr:nth-child(4), tr:nth-child(5)";i(".simpay-settings.stripe-account .form-table").find(e).hide(),i("#wpsp-api-keys-row-reveal button").on("click",(function(t){t.preventDefault(),i(".simpay-settings.stripe-account .form-table").find(e).show(),i("#wpsp-api-keys-row-hide").show(),i(this).parent().hide(),i(".wpsp-manual-key-warning").show()})),i("#wpsp-api-keys-row-hide button").on("click",(function(t){t.preventDefault(),i(".simpay-settings.stripe-account .form-table").find(e).hide(),i("#wpsp-api-keys-row-reveal").show(),i(this).parent().hide(),i(".wpsp-manual-key-warning").hide()}))},handleInternalLinkToTabClicks:function(e){var t=e.data("show-tab");a.find("."+t+"-tab a").click()}},(i=e)(document).ready((function(e){c.init()}))}.call(this,n(22))},332:function(e,t,n){"use strict";var r=n(12),i=simpayAdminSettingToggles||[];function a(e){var t=e.id,n=(e.value,e.toggles,document.querySelector(".simpay-settings-".concat(t)));if(!n)return{};var r=n.querySelector("input");r||(r=n.querySelector("select"));var i=r.value;return"checkbox"===r.type&&(i=!0===r.checked?"yes":"no"),{setting:r,currentValue:i}}function o(e){var t=e.id,n=e.value,r=e.toggles,c=a(e),s=(c.setting,c.currentValue);"none"!==document.querySelector(".simpay-settings-".concat(t)).style.display&&(r.map((function(e){return document.querySelector(".simpay-settings-".concat(e))})).forEach((function(e){e&&(e.style.display=s===n?"table-row":"none")})),r.forEach((function(e){var t=_.find(i,{id:e});t&&o(t)})))}Object(r.a)((function(){i.forEach((function(e){o(e),a(e).setting.addEventListener("change",(function(){return o(e)}))}))}))},333:function(e,t,n){"use strict";var r=n(12);Object(r.a)((function(){var e=window.wpsp.hooks,t=document.querySelectorAll('[name="simpay_settings[test_mode]"]'),n=document.querySelector('[name="simpay_settings[test_mode]"]:checked');if(0!==t.length){var r="enabled"===n.value?"test":"live";e.doAction("settings.toggleTestMode",r,r),_.each(t,(function(t){return t.addEventListener("change",(function(t){var n="enabled"===t.target.value?"test":"live";e.doAction("settings.toggleTestMode",n,"test"===n?"live":"test")}))}))}}))},334:function(e,t,n){"use strict";var r=n(12);Object(r.a)((function(){var e=document.querySelector(".simpay-recaptcha-feedback");if(e){var t=simpayGoogleRecaptcha,n=t.siteKey,r=t.i18n;""!==n&&grecaptcha.ready((function(){var e=document.querySelector(".grecaptcha-badge");e&&(e.style.display="none");try{grecaptcha.execute(n,{action:"simple_pay_admin_test"}).then((function(e){wp.ajax.send("simpay_validate_recaptcha_source",{data:{token:e,recaptcha_action:"simple_pay_admin_test"},error:i})})).catch(i)}catch(e){i()}}))}function i(){e.style.display="block",e.classList.add("notice-error"),e.querySelector("p").innerText=r.invalid}}))},335:function(e,t,n){"use strict";(function(e,t){var r=n(55),i=n.n(r),a=n(12);function o(e){var t=e.querySelector(".simpay-price-label-display"),n=e.querySelector(".simpay-price-label"),r=spGeneral.strings,i=r.recurringIntervalDisplay,a=r.customAmountLabel;if(""!==n.value)t.innerHTML=n.value;else{var o,c=e.querySelector(".simpay-price-currency"),s=e.querySelector(".simpay-price-amount"),l=e.querySelector(".simpay-price-amount-type"),u=e.querySelector(".simpay-price-custom-amount input"),d=e.querySelector(".simpay-price-enable-custom-amount"),p=spGeneral.strings,m=p.currencyPosition,y=p.recurringIntervals,f=c.options[c.selectedIndex].dataset.symbol;switch(o=!0===d.checked?u.value:s.value,m){case"left":o="".concat(f).concat(o);break;case"left_space":o="".concat(f," ").concat(o);break;case"right":o="".concat(o).concat(f);break;case"right_space":o="".concat(o," ").concat(f)}if(!0===d.checked&&(o=a.replace("%s",o)),"recurring"===l.value){var v=e.querySelector(".simpay-price-recurring-interval"),h=e.querySelector(".simpay-price-recurring-interval-count"),g=y[v.options[v.selectedIndex].value];o=i.replace("%1$s",o).replace("%2$s",h.value).replace("%3$s","1"===h.value?g[0]:g[1])}t.innerHTML=o}}function c(e,t){e.querySelector(".simpay-price-recurring-settings").style.display=t.checked?"block":"none"}function s(e){var t=e.querySelector(".simpay-price-recurring-interval"),n=e.querySelector(".simpay-price-recurring-interval-count"),r=parseInt(n.value),a=t.options[t.selectedIndex].value,o=JSON.parse(t.dataset.intervals);switch(i()(t.options).forEach((function(e,n){var i=e.value;t.options[n].text=1===r?o[i][0]:o[i][1]})),a){case"day":r>1825&&(n.value=1825);break;case"week":r>260&&(n.value=260);break;case"month":r>60&&(n.value=60);break;case"year":r>5&&(n.value=5)}}function l(){var e=document.querySelectorAll(".simpay-price");_.each(e,(function(e){var t=e.querySelector(".simpay-price-amount-type").value;e.querySelector(".simpay-price-label").addEventListener("keyup",(function(){return o(e)})),o(e),e.querySelector(".simpay-price-currency").addEventListener("change",(function(){!function(e){var t=e.querySelector(".simpay-price-currency"),n=t.options[t.selectedIndex].dataset.symbol,r=e.querySelectorAll(".simpay-price-currency-symbol");_.each(r,(function(e){return e.innerText=n}))}(e),o(e)}));var n=e.querySelectorAll(".simpay-price-amount-type .button");n.length>0&&_.each(n,(function(t){return t.addEventListener("click",(function(t){t.preventDefault(),function(e,t){var n=e.querySelectorAll(".simpay-price-amount-type .button");_.each(n,(function(e){return e.classList.remove("button-primary")}));var r=t.dataset.amountType,i=e.querySelector(".simpay-price-recurring-settings");t.classList.add("button-primary"),i.style.display="recurring"===r?"block":"none";var a=e.querySelector(".simpay-price-recurring-amount-toggle"),o=e.querySelector(".simpay-price-enable-optional-subscription");a.style.display="recurring"===r?"none":"block",o.checked=!1,e.querySelector(".simpay-price-amount-type").value=r}(e,t.target),o(e)}))})),e.querySelector(".simpay-price-amount").addEventListener("keyup",(function(){return o(e)}));var r=e.querySelector(".simpay-price-enable-optional-subscription");r&&(r.addEventListener("click",(function(t){var n=t.target;c(e,n),o(e)})),"recurring"!==t&&c(e,r)),e.querySelector(".simpay-price-enable-custom-amount").addEventListener("click",(function(){!function(e){var t=e.querySelector(".simpay-price-custom-amount");t.style.display="none"===t.style.display?"block":"none"}(e),o(e)})),e.querySelector(".simpay-price-recurring-interval").addEventListener("change",(function(){o(e),s(e)}));var i=e.querySelector(".simpay-price-recurring-interval-count");i.addEventListener("keyup",(function(){s(e),o(e)})),i.addEventListener("change",(function(){s(e),o(e)}));var a=e.querySelector(".simpay-price-legacy-setting-toggle");a&&a.addEventListener("click",(function(t){t.preventDefault(),function(e){var t=e.querySelectorAll(".simpay-price-legacy-setting");_.each(t,(function(e){return e.style.display="block"===e.style.display?"none":"block"}))}(e)})),e.querySelector(".simpay-price-default").addEventListener("change",(function(){return function(e){var t=document.querySelectorAll(".simpay-price-default");_.each(t,(function(e){return e.checked=!1})),e.querySelector(".simpay-price-default").checked=!0}(e)})),e.querySelector(".simpay-price-remove").addEventListener("click",(function(t){t.preventDefault(),function(e){e.remove(),u()}(e)}))}))}function u(){var e=document.querySelectorAll(".simpay-price");document.querySelector(".simpay-price-default:checked")||(e[0].querySelector(".simpay-price-default").checked=!0)}Object(a.a)((function(){var n,r,i;t(".simpay-prices").sortable({items:".simpay-field-metabox",containment:"#simpay-prices",handle:".simpay-hndle",placeholder:"sortable-placeholder",cursor:"move",delay:t(document.body).hasClass("mobile")?200:0,distance:2,tolerance:"pointer",forcePlaceholderSize:!0,opacity:.65,helper:function(e,t){return t.clone().find(":input").attr("name",(function(e,t){return"sort_"+parseInt(1e5*Math.random(),10).toString()+"_"+t})).end()}}),l(),n=document.getElementById("simpay-prices-advanced-toggle"),r=document.getElementById("simpay-prices-advanced"),n&&r&&n.addEventListener("click",(function(e){e.preventDefault(),r.style.display="block"==r.style.display?"none":"block"})),(i=document.getElementById("simpay-prices-advanced-add"))&&i.addEventListener("click",(function(t){var n,r,a,o,c,s;t.preventDefault(),a=(r=(n=i).dataset).nonce,o=r.formId,c=document.getElementById("simpay-prices"),s=document.getElementById("simpay-prices-advanced-plan-id"),n.classList.add("disabled"),wp.ajax.send("simpay_add_plan",{data:{_wpnonce:a,form_id:o,plan_id:s.value},success:function(t){e(c).append(t),l(),document.getElementById("simpay-prices-advanced").style.display="none",s.value="",n.classList.remove("disabled")},error:function(e){var t=e.message;alert(t),n.classList.remove("disabled")}})})),function(){var t=document.getElementById("simpay-add-price");t&&t.addEventListener("click",(function(n){var r,i,a,o,c;n.preventDefault(),a=(i=(r=t).dataset).nonce,o=i.formId,c=document.getElementById("simpay-prices"),r.classList.add("disabled"),wp.ajax.send("simpay_add_price",{data:{_wpnonce:a,form_id:o},success:function(t){e(c).append(t),l(),u(),r.classList.remove("disabled")},error:function(e){var t=e.message;alert(t),r.classList.remove("disabled")}})}))}()}))}).call(this,n(22),n(22))},55:function(e,t,n){var r=n(107),i=n(108),a=n(109),o=n(110);e.exports=function(e){return r(e)||i(e)||a(e)||o()},e.exports.default=e.exports,e.exports.__esModule=!0},62:function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.default=e.exports,e.exports.__esModule=!0}});