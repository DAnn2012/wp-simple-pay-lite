{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./assets/js/admin-subs.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","spSubAdmin","$","body","spSubSettings","init","document","find","this","loadMultiPlanSubscriptions","initSortablePlans","on","e","preventDefault","addPlan","removePlan","setDefaultPlan","updateDefaultPlan","updatePlanSelect","togglePlans","val","trigger","el","sortable","items","cursor","axis","handle","scrollSensitivity","forcePlaceholderSize","opacity","stop","ui","orderPlans","helper","event","element","clone","attr","currentName","parseInt","Math","random","toString","end","simpayPlans","sort","a","b","compA","compB","each","idx","itm","append","is","prop","fieldKey","parent","data","savedDefaultField","getElementById","selectedDefaultField","querySelector","dataset","planId","firstRadio","checked","plan","closest","index","planIndex","wrapper","action","counter","addPlanNonce","ajax","url","ajaxurl","method","success","response","chosen","error","spShared","debugLog","remove","ready","jQuery"],"mappings":"aACA,IAAAA,EAAA,GAGA,SAAAC,EAAAC,GAGA,GAAAF,EAAAE,GACA,OAAAF,EAAAE,GAAAC,QAGA,IAAAC,EAAAJ,EAAAE,GAAA,CACAG,EAAAH,EACAI,GAAA,EACAH,QAAA,IAUA,OANAI,EAAAL,GAAAM,KAAAJ,EAAAD,QAAAC,IAAAD,QAAAF,GAGAG,EAAAE,GAAA,EAGAF,EAAAD,QAKAF,EAAAQ,EAAAF,EAGAN,EAAAS,EAAAV,EAGAC,EAAAU,EAAA,SAAAR,EAAAS,EAAAC,GACAZ,EAAAa,EAAAX,EAAAS,IACAG,OAAAC,eAAAb,EAAAS,EAAA,CAA0CK,YAAA,EAAAC,IAAAL,KAK1CZ,EAAAkB,EAAA,SAAAhB,GACA,oBAAAiB,eAAAC,aACAN,OAAAC,eAAAb,EAAAiB,OAAAC,YAAA,CAAwDC,MAAA,WAExDP,OAAAC,eAAAb,EAAA,cAAiDmB,OAAA,KAQjDrB,EAAAsB,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAArB,EAAAqB,IACA,EAAAE,EAAA,OAAAF,EACA,KAAAE,GAAA,iBAAAF,QAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAX,OAAAY,OAAA,MAGA,GAFA1B,EAAAkB,EAAAO,GACAX,OAAAC,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,UACzC,EAAAE,GAAA,iBAAAF,EAAA,QAAAM,KAAAN,EAAArB,EAAAU,EAAAe,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIAzB,EAAA6B,EAAA,SAAA1B,GACA,IAAAS,EAAAT,KAAAqB,WACA,WAA2B,OAAArB,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAH,EAAAU,EAAAE,EAAA,IAAAA,GACAA,GAIAZ,EAAAa,EAAA,SAAAiB,EAAAC,GAAsD,OAAAjB,OAAAkB,UAAAC,eAAA1B,KAAAuB,EAAAC,IAGtD/B,EAAAkC,EAAA,GAIAlC,IAAAmC,EAAA,uBChFA,IAAIC,EAAa,IAEf,SAAUC,GACX,aAEA,IAAIC,EACHC,EAEDH,EAAa,CAEZI,KAAM,WAGLF,EAAOD,EAAGI,SAASH,MACnBC,EAAgBD,EAAKI,KAAM,wCAE3BC,KAAKC,6BAGLD,KAAKE,kBAAmBN,EAAcG,KAAM,sCAG5CH,EAAcG,KAAM,oBAAqBI,GAAI,sBAAuB,SAAUC,GAE7EA,EAAEC,iBAEFZ,EAAWa,QAASF,KAIrBR,EAAcG,KAAM,uBAAwBI,GAAI,yBAA0B,sBAAuB,SAAUC,GAC1GX,EAAWc,WAAYb,EAAGM,MAAQI,KAInCX,EAAWe,iBAGXZ,EAAcG,KAAM,+BAAgCI,GAAI,gCAAiC,iDAAkD,SAAUC,GACpJX,EAAWgB,kBAAmBf,EAAGM,SAIlCJ,EAAcG,KAAM,+BAAgCI,GAAI,gCAAiC,4BAA6B,SAAUC,GAC/HX,EAAWiB,iBAAkBhB,EAAGM,SAIjCJ,EAAcG,KAAM,gCAAiCA,KAAM,uBAAwBI,GAAI,kCAAmC,SAAUC,GACnIX,EAAWkB,YAAajB,EAAGM,SAIvB,KAAOJ,EAAcG,KAAM,oCAAqCa,OACpEhB,EAAcG,KAAM,wDAAyDc,QAAS,kCAIxFX,kBAAmB,SAAUY,GAE5BA,EAAGC,SAAU,CACZC,MAAO,KACPC,OAAQ,OACRC,KAAM,IACNC,OAAQ,iBACRC,kBAAmB,GACnBC,sBAAsB,EACtBC,QAAS,IACTC,KAAM,SAAUnB,EAAGoB,GAClB/B,EAAWgC,cAIZC,OAAQ,SAAUC,EAAOC,GAQxB,OAAOA,EAAQC,QACb9B,KAAM,UACN+B,KAAM,OAAQ,SAAUrE,EAAGsE,GAC3B,MAAO,QAAUC,SAA0B,IAAhBC,KAAKC,SAAmB,IAAKC,WAAa,IAAMJ,IAE3EK,UAKLnC,2BAA4B,WAE3B,IAAIoC,EAAczC,EAAcG,KAAM,qBAAsBzB,MAE5D+D,EAAYC,KAAM,SAAUC,EAAGC,GAC9B,IAAIC,EAAQT,SAAUtC,EAAG6C,GAAIT,KAAM,OAAS,IACxCY,EAAQV,SAAUtC,EAAG8C,GAAIV,KAAM,OAAS,IAC5C,OAASW,EAAQC,GAAW,EAAMD,EAAQC,EAAU,EAAI,IAGzD9C,EAAcG,KAAMsC,GAAcM,KAAM,SAAUC,EAAKC,GACtDjD,EAAcG,KAAM,qCAAsC+C,OAAQD,MAIpElC,YAAa,SAAUG,GAIjB,YAAcA,EAAGF,OAASE,EAAGiC,GAAI,YACrCpD,EAAKI,KAAM,iBAAkBiD,KAAM,YAAY,GAAOnC,QAAS,kBAE/DlB,EAAKI,KAAM,iBAAkBiD,KAAM,YAAY,GAAQnC,QAAS,mBAIlEH,iBAAkB,SAAUI,GAE3B,IAAImC,EAAWnC,EAAGoC,SAASC,KAAM,aAE5BvD,EAAcG,KAAM,2CAA6CkD,EAAW,QAASF,GAAI,aAC7FnD,EAAcG,KAAM,oCAAqCa,IAAKE,EAAGf,KAAM,mBAAoBa,QAO7FJ,eAAgB,WACf,IAAI4C,EAAoBtD,SAASuD,eAAgB,mCAC7CC,EAAuBxD,SAASyD,cAAe,4CAGnD,KAAKD,GAA0BA,EAAqBE,QAAQC,SAAWL,EAAkB1E,QAKpF4E,GAA0BA,EAAqBE,QAAQC,SAAWL,EAAkB1E,QACxF0E,EAAkB1E,MAAQ4E,EAAqBE,QAAQC,QAIjDH,IAAuB,CAC7B,IAAII,EAAa5D,SAASyD,cAAe,oCAEzC,IAAOG,EACN,OAIDA,EAAWC,SAAU,EAGrBP,EAAkB1E,MAAQgF,EAAWF,QAAQC,SAI/ChD,kBAAmB,SAAUK,GAE5B,IAAI8C,EAAO9C,EAAG+C,QAAS,8BAA+BX,SAASnD,KAAM,6BAA8BA,KAAM,mBAAoBa,MAE7HhB,EAAcG,KAAM,oCAAqCa,IAAKgD,IAG/DnC,WAAY,WAEX7B,EAAcG,KAAM,qBAAsB4C,KAAM,SAAUmB,EAAOhD,GAEhE,IAAIiD,EAAY/B,SAAUtC,EAAGoB,GAAKgD,MAAO,sBAEzClE,EAAcG,KAAM,cAAee,GAAKF,IAAKmD,MAI/CzD,QAAS,SAAUF,GAElB,IAAI4D,EAAUpE,EAAcG,KAAM,qCAG9BoD,EAAO,CACVc,OAAQ,kBACRC,QAJgBlC,SAAUpC,EAAcG,KAAM,0BAA2BoD,KAAM,cAAkB,EAKjGgB,aAAcxE,EAAKI,KAAM,0BAA2Ba,OAGrDR,EAAEC,iBAEFX,EAAE0E,KAAM,CACPC,IAAKC,QACLC,OAAQ,OACRpB,KAAMA,EACNqB,QAAS,SAAUC,GAElBT,EAAQlB,OAAQ2B,GAChBT,EAAQjE,KAAM,UAAW2E,UAG1BC,MAAO,SAAUF,GAChBG,SAASC,SAAUJ,OAKtBlE,WAAY,SAAUO,EAAIV,GACzBA,EAAEC,iBAEFS,EAAG+C,QAAS,qBAAsBiB,SAClCrF,EAAWe,mBAIbd,EAAGI,UAAWiF,MAAO,SAAUrF,GAC9BD,EAAWI,SApNX,CAuNCmF","file":"assets/js/admin-subs.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 15);\n","/* global jQuery */\n\nvar spSubAdmin = {};\n\n( function( $ ) {\n\t'use strict';\n\n\tvar body,\n\t\tspSubSettings;\n\n\tspSubAdmin = {\n\n\t\tinit: function() {\n\n\t\t\t// We need to initialize these here because that's when the document is finally ready\n\t\t\tbody = $( document.body );\n\t\t\tspSubSettings = body.find( '#subscription-options-settings-panel' );\n\n\t\t\tthis.loadMultiPlanSubscriptions();\n\n\t\t\t// Initialize sortable fields for multi-plans\n\t\t\tthis.initSortablePlans( spSubSettings.find( '.simpay-multi-subscriptions tbody' ) );\n\n\t\t\t// Add plan button\n\t\t\tspSubSettings.find( '.simpay-add-plan' ).on( 'click.simpayAddPlan', function( e ) {\n\n\t\t\t\te.preventDefault();\n\n\t\t\t\tspSubAdmin.addPlan( e );\n\t\t\t} );\n\n\t\t\t// Remove Plan action\n\t\t\tspSubSettings.find( '.simpay-panel-field' ).on( 'click.simpayRemovePlan', '.simpay-remove-plan', function( e ) {\n\t\t\t\tspSubAdmin.removePlan( $( this ), e );\n\t\t\t} );\n\n\t\t\t// Search for and set the default plan on load.\n\t\t\tspSubAdmin.setDefaultPlan();\n\n\t\t\t// Update default subscription\n\t\t\tspSubSettings.find( '.simpay-multi-subscriptions' ).on( 'click.simpayUpdateDefaultPlan', '.simpay-multi-plan-default input[type=\"radio\"]', function( e ) {\n\t\t\t\tspSubAdmin.updateDefaultPlan( $( this ) );\n\t\t\t} );\n\n\t\t\t// Trigger update of plan ID on change of select\n\t\t\tspSubSettings.find( '.simpay-multi-subscriptions' ).on( 'change.simpayUpdatePlanSelect', '.simpay-multi-plan-select', function( e ) {\n\t\t\t\tspSubAdmin.updatePlanSelect( $( this ) );\n\t\t\t} );\n\n\t\t\t// Enable/Disable single subscription plan dropdown\n\t\t\tspSubSettings.find( '#_subscription_custom_amount' ).find( 'input[type=\"radio\"]' ).on( 'change.simpayToggleSubscription', function( e ) {\n\t\t\t\tspSubAdmin.togglePlans( $( this ) );\n\t\t\t} );\n\n\t\t\t// Trigger for default plan value if none are selected\n\t\t\tif ( '' === spSubSettings.find( '#simpay-multi-plan-default-value' ).val() ) {\n\t\t\t\tspSubSettings.find( '.simpay-multi-plan-default input[type=\"radio\"]:first' ).trigger( 'click.simpayUpdateDefaultPlan' );\n\t\t\t}\n\t\t},\n\n\t\tinitSortablePlans: function( el ) {\n\n\t\t\tel.sortable( {\n\t\t\t\titems: 'tr',\n\t\t\t\tcursor: 'move',\n\t\t\t\taxis: 'y',\n\t\t\t\thandle: 'td.sort-handle',\n\t\t\t\tscrollSensitivity: 40,\n\t\t\t\tforcePlaceholderSize: true,\n\t\t\t\topacity: 0.65,\n\t\t\t\tstop: function( e, ui ) {\n\t\t\t\t\tspSubAdmin.orderPlans();\n\t\t\t\t},\n\n\t\t\t\t// @link https://core.trac.wordpress.org/changeset/35809\n\t\t\t\thelper: function( event, element ) {\n\t\t\t\t\t/* `helper: 'clone'` is equivalent to `return element.clone();`\n\t\t\t\t\t * Cloning a checked radio and then inserting that clone next to the original\n\t\t\t\t\t * radio unchecks the original radio (since only one of the two can be checked).\n\t\t\t\t\t * We get around this by renaming the helper's inputs' name attributes so that,\n\t\t\t\t\t * when the helper is inserted into the DOM for the sortable, no radios are\n\t\t\t\t\t * duplicated, and no original radio gets unchecked.\n\t\t\t\t\t */\n\t\t\t\t\treturn element.clone()\n\t\t\t\t\t\t.find( ':input' )\n\t\t\t\t\t\t.attr( 'name', function( i, currentName ) {\n\t\t\t\t\t\t\treturn 'sort_' + parseInt( Math.random() * 100000, 10 ).toString() + '_' + currentName;\n\t\t\t\t\t\t} )\n\t\t\t\t\t\t.end();\n\t\t\t\t}\n\t\t\t} );\n\t\t},\n\n\t\tloadMultiPlanSubscriptions: function() {\n\n\t\t\tvar simpayPlans = spSubSettings.find( '.simpay-multi-sub' ).get();\n\n\t\t\tsimpayPlans.sort( function( a, b ) {\n\t\t\t\tvar compA = parseInt( $( a ).attr( 'rel' ), 10 );\n\t\t\t\tvar compB = parseInt( $( b ).attr( 'rel' ), 10 );\n\t\t\t\treturn ( compA < compB ) ? -1 : ( compA > compB ) ? 1 : 0;\n\t\t\t} );\n\n\t\t\tspSubSettings.find( simpayPlans ).each( function( idx, itm ) {\n\t\t\t\tspSubSettings.find( '.simpay-multi-subscriptions tbody' ).append( itm );\n\t\t\t} );\n\t\t},\n\n\t\ttogglePlans: function( el ) {\n\n\t\t\t// TODO DRY\n\n\t\t\tif ( 'enabled' === el.val() && el.is( ':checked' ) ) {\n\t\t\t\tbody.find( '#_single_plan' ).prop( 'disabled', true ).trigger( 'chosen:updated' );\n\t\t\t} else {\n\t\t\t\tbody.find( '#_single_plan' ).prop( 'disabled', false ).trigger( 'chosen:updated' );\n\t\t\t}\n\t\t},\n\n\t\tupdatePlanSelect: function( el ) {\n\n\t\t\tvar fieldKey = el.parent().data( 'field-key' );\n\n\t\t\tif ( spSubSettings.find( '#simpay-subscription-multi-plan-default-' + fieldKey + '-yes' ).is( ':checked' ) ) {\n\t\t\t\tspSubSettings.find( '#simpay-multi-plan-default-value' ).val( el.find( 'option:selected' ).val() );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Validate (and potentially fix) the default subscription plan.\n\t\t */\n\t\tsetDefaultPlan: function() {\n\t\t\tvar savedDefaultField = document.getElementById( 'simpay-multi-plan-default-value' );\n\t\t\tvar selectedDefaultField = document.querySelector( '.simpay-multi-plan-default input:checked' );\n\n\t\t\t// Selected radio matches saved meta, do nothing.\n\t\t\tif ( selectedDefaultField && ( selectedDefaultField.dataset.planId === savedDefaultField.value ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// There is a selected default but it doesn't match, so update the hidden field.\n\t\t\tif ( selectedDefaultField && ( selectedDefaultField.dataset.planId !== savedDefaultField.value ) ) {\n\t\t\t\tsavedDefaultField.value = selectedDefaultField.dataset.planId;\n\t\t\t}\n\n\t\t\t// There is no selected default, updated the saved meta with the first option.\n\t\t\tif ( ! selectedDefaultField ) {\n\t\t\t\tvar firstRadio = document.querySelector( '.simpay-multi-plan-default input' );\n\n\t\t\t\tif ( ! firstRadio ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Check...\n\t\t\t\tfirstRadio.checked = true;\n\n\t\t\t\t// Set hidden value.\n\t\t\t\tsavedDefaultField.value = firstRadio.dataset.planId;\n\t\t\t}\n\t\t},\n\n\t\tupdateDefaultPlan: function( el ) {\n\n\t\t\tvar plan = el.closest( '.simpay-multi-plan-default' ).parent().find( '.simpay-multi-plan-select' ).find( 'option:selected' ).val();\n\n\t\t\tspSubSettings.find( '#simpay-multi-plan-default-value' ).val( plan );\n\t\t},\n\n\t\torderPlans: function() {\n\n\t\t\tspSubSettings.find( '.simpay-multi-sub' ).each( function( index, el ) {\n\n\t\t\t\tvar planIndex = parseInt( $( el ).index( '.simpay-multi-sub' ) );\n\n\t\t\t\tspSubSettings.find( '.plan-order', el ).val( planIndex );\n\t\t\t} );\n\t\t},\n\n\t\taddPlan: function( e ) {\n\n\t\t\tvar wrapper = spSubSettings.find( '.simpay-multi-subscriptions tbody' ); // Main table\n\t\t\tvar currentKey = parseInt( spSubSettings.find( '.simpay-multi-sub:last' ).data( 'field-key' ) ) + 1; // Counter from tr\n\n\t\t\tvar data = {\n\t\t\t\taction: 'simpay_add_plan',\n\t\t\t\tcounter: currentKey,\n\t\t\t\taddPlanNonce: body.find( '#simpay_add_plan_nonce' ).val()\n\t\t\t};\n\n\t\t\te.preventDefault();\n\n\t\t\t$.ajax( {\n\t\t\t\turl: ajaxurl,\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdata: data,\n\t\t\t\tsuccess: function( response ) {\n\n\t\t\t\t\twrapper.append( response );\n\t\t\t\t\twrapper.find( 'select' ).chosen();\n\n\t\t\t\t},\n\t\t\t\terror: function( response ) {\n\t\t\t\t\tspShared.debugLog( response );\n\t\t\t\t}\n\t\t\t} );\n\t\t},\n\n\t\tremovePlan: function( el, e ) {\n\t\t\te.preventDefault();\n\n\t\t\tel.closest( '.simpay-multi-sub' ).remove();\n\t\t\tspSubAdmin.setDefaultPlan();\n\t\t}\n\t};\n\n\t$( document ).ready( function( $ ) {\n\t\tspSubAdmin.init();\n\t} );\n\n}( jQuery ) );\n"],"sourceRoot":""}